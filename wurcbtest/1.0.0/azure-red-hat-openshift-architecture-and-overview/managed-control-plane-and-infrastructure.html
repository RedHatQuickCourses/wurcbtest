<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Managed control plane and infrastructure :: Advanced Administration of Azure Red Hat OpenShift</title>
    <link rel="prev" href="joint-engineering-operation-and-support-model.html">
    <link rel="next" href="../aro-cluster-provisioning/aro-cluster-provisioning.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Advanced Administration of Azure Red Hat OpenShift</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="wurcbtest" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="azure-red-hat-openshift-architecture-and-overview.html">Azure Red Hat OpenShift Architecture and Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="aro-platform-capabilities.html">ARO platform capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="joint-engineering-operation-and-support-model.html">Joint engineering, operation, and support model</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="managed-control-plane-and-infrastructure.html">Managed control plane and infrastructure</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../aro-cluster-provisioning/aro-cluster-provisioning.html">ARO Cluster Provisioning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../aro-cluster-provisioning/creating-an-azure-red-hat-openshift-cluster.html">Creating an Azure Red Hat OpenShift cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../aro-cluster-provisioning/creating-a-private-azure-red-hat-openshift-cluster.html">Creating a private Azure Red Hat OpenShift cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-cluster-configuration/core-cluster-configuration.html">Core Cluster Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-additional-storage-classes.html">Configuring additional storage classes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/creating-dedicated-machine-sets.html">Creating dedicated machine sets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-node-autoscaling.html">Configuring node autoscaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-log-forwarding.html">Configuring log forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-custom-dns-and-dns-forwarding.html">Configuring custom DNS and DNS forwarding</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../registry-integrations/registry-integrations.html">Registry Integrations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/integrating-with-azure-container-registry-acr.html">Integrating with Azure Container Registry (ACR)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/integrating-with-quay.html">Integrating with Quay</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/using-the-internal-openshift-registry.html">Using the internal OpenShift registry</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cluster-application-data-management/cluster-application-data-management.html">Cluster Application Data Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-application-data-management/backup-and-restore-of-cluster-applications-using-velero.html">Backup and restore of cluster applications using Velero</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/openshift-and-kubernetes-interfaces.html">OpenShift and Kubernetes Interfaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/navigating-the-openshift-web-console.html">Navigating the OpenShift Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/utilizing-the-kubernetes-command-line-interface-cli.html">Utilizing the Kubernetes Command-line Interface (CLI)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/utilizing-the-openshift-command-line-interface-cli.html">Utilizing the OpenShift Command-line Interface (CLI)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../troubleshooting-and-application-management/troubleshooting-and-application-management.html">Troubleshooting and Application Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-and-application-management/troubleshooting-containers-and-pods.html">Troubleshooting containers and pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-and-application-management/managing-applications-using-the-kubernetes-workload-api.html">Managing applications using the Kubernetes Workload API</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../kubernetes-networking-and-application-exposure/kubernetes-networking-and-application-exposure.html">Kubernetes Networking and Application Exposure</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes-networking-and-application-exposure/understanding-kubernetes-pod-and-service-networks.html">Understanding Kubernetes Pod and Service Networks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes-networking-and-application-exposure/scaling-and-exposing-applications-to-external-access.html">Scaling and exposing applications to external access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../kubernetes-networking-and-application-exposure/externalizing-application-configurations.html">Externalizing application configurations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../network-security-policies/network-security-policies.html">Network Security Policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-security-policies/configuring-network-policies.html">Configuring network policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-security-policies/limiting-ingress-traffic.html">Limiting ingress traffic</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../gitops-for-cluster-administration/gitops-for-cluster-administration.html">GitOps for Cluster Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gitops-for-cluster-administration/implementing-openshift-gitops.html">Implementing OpenShift GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gitops-for-cluster-administration/using-argocd-for-declarative-cluster-management.html">Using ArgoCD for declarative cluster management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../multi-cluster-management/multi-cluster-management.html">Multi-Cluster Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../multi-cluster-management/overview-of-red-hat-advanced-cluster-management-rhacm.html">Overview of Red Hat Advanced Cluster Management (RHACM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../multi-cluster-management/managing-kubernetes-clusters-with-rhacm.html">Managing Kubernetes clusters with RHACM</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../knowledge-share-and-discussions/knowledge-share-and-discussions.html">Knowledge Share and Discussions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/integrating-azure-ad-with-openshift-oauth.html">Integrating Azure AD with OpenShift OAuth</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/integrating-azure-key-vault-with-aro.html">Integrating Azure Key Vault with ARO</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/differentiating-availability-sets-vs-availability-zones.html">Differentiating Availability Sets vs. Availability Zones</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/understanding-azure-spot-instances.html">Understanding Azure Spot Instances</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/exploring-hosted-control-planes.html">Exploring Hosted Control Planes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab/hands-on-lab.html">Hands-on Lab</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-an-azure-red-hat-openshift-cluster.html">Create an Azure Red Hat OpenShift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-additional-storage-classes.html">Configure additional storage classes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-dedicated-machine-sets.html">Create dedicated machine sets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-node-autoscaling.html">Configure node autoscaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-log-forwarding.html">Configure log forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-a-private-azure-red-hat-openshift-cluster.html">Create a private Azure Red Hat OpenShift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-custom-dns-and-dns-forwarding.html">Configure custom DNS and DNS forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/implement-registry-integrations-with-aro.html">Implement registry integrations with ARO</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/perform-backup-and-restore-of-a-cluster-application-with-velero.html">Perform backup and restore of a cluster application with Velero</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/troubleshoot-containers-and-pods.html">Troubleshoot containers and pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/manage-applications-using-the-kubernetes-workload-api.html">Manage applications using the Kubernetes Workload API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/explore-kubernetes-pod-and-service-networks.html">Explore Kubernetes Pod and Service Networks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/scale-and-expose-applications-to-external-access.html">Scale and expose applications to external access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/externalize-application-configurations.html">Externalize application configurations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-network-policies-and-limit-ingress-traffic.html">Configure network policies and limit ingress traffic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/implement-gitops-for-cluster-administration.html">Implement GitOps for cluster administration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/manage-a-cluster-using-red-hat-advanced-cluster-management.html">Manage a cluster using Red Hat Advanced Cluster Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Advanced Administration of Azure Red Hat OpenShift</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a></li>
    <li><a href="azure-red-hat-openshift-architecture-and-overview.html">Azure Red Hat OpenShift Architecture and Overview</a></li>
    <li><a href="managed-control-plane-and-infrastructure.html">Managed control plane and infrastructure</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Managed control plane and infrastructure</h1>
<h1 id="_managed_control_plane_and_infrastructure" class="sect0"><a class="anchor" href="#_managed_control_plane_and_infrastructure"></a>Managed Control Plane and Infrastructure</h1>
<div class="quoteblock abstract">
<blockquote>
This module delves into the "managed" aspect of Azure Red Hat OpenShift (ARO), explaining how Microsoft and Red Hat jointly operate the Kubernetes control plane and underlying infrastructure. You&#8217;ll learn about the benefits of this shared responsibility model, the specific roles of each party, and how customers gain visibility into the managed components through logging.
</blockquote>
</div>
<div class="sect1">
<h2 id="_the_aro_managed_service_model"><a class="anchor" href="#_the_aro_managed_service_model"></a>The ARO Managed Service Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Azure Red Hat OpenShift (ARO) stands out as a fully managed service, which fundamentally redefines the operational responsibilities typically associated with self-managing an OpenShift cluster on a cloud provider. In ARO, the complexity of maintaining the Kubernetes control plane and much of the underlying infrastructure is offloaded to a joint engineering, operation, and support team from Microsoft and Red Hat.</p>
</div>
<div class="sect2">
<h3 id="_managed_control_plane"><a class="anchor" href="#_managed_control_plane"></a>Managed Control Plane</h3>
<div class="paragraph">
<p>The <strong>control plane</strong> (also known as the master nodes in OpenShift terminology) is the brain of your Kubernetes cluster. It orchestrates all operations, manages the cluster state, and ensures that your desired application state is maintained. In ARO, the control plane includes critical components such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>kube-apiserver</strong>: The front end for the Kubernetes control plane, exposing the Kubernetes API.</p>
</li>
<li>
<p><strong>etcd</strong>: A consistent and highly available key-value store used to store all cluster data.</p>
</li>
<li>
<p><strong>kube-scheduler</strong>: Watches for newly created Pods with no assigned node and selects a node for them to run on.</p>
</li>
<li>
<p><strong>kube-controller-manager</strong>: Runs various controller processes (e.g., node controller, replication controller, endpoints controller, service account controller, token controller).</p>
</li>
<li>
<p><strong>cloud-controller-manager</strong>: Integrates the cluster with the underlying Azure cloud platform (e.g., managing load balancers, persistent volumes, node lifecycle).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With a managed control plane, Microsoft and Red Hat are responsible for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Provisioning and lifecycle management</strong>: Deploying, upgrading, patching, and maintaining the control plane nodes.</p>
</li>
<li>
<p><strong>High availability</strong>: Ensuring the control plane components are resilient to failures.</p>
</li>
<li>
<p><strong>Security</strong>: Applying security patches and hardening the control plane.</p>
</li>
<li>
<p><strong>Monitoring and alerting</strong>: Proactive monitoring of control plane health and performance.</p>
</li>
<li>
<p><strong>Capacity management</strong>: Monitoring utilization and scaling/resizing control plane nodes to maintain quality of service, as highlighted in the provided context under "Capacity Management" for "Control plane nodes" (Table 1 and Table 3).</p>
</li>
<li>
<p><strong>Upgrades</strong>: Communicating schedule and status of upgrades for minor and maintenance versions, initiating upgrades, and publishing changelogs (Table 3).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This model significantly reduces the operational overhead for customers, allowing them to focus on application development and deployment rather than infrastructure management.</p>
</div>
</div>
<div class="sect2">
<h3 id="_managed_infrastructure"><a class="anchor" href="#_managed_infrastructure"></a>Managed Infrastructure</h3>
<div class="paragraph">
<p>Beyond the control plane, ARO also manages a substantial portion of the underlying Azure infrastructure that supports the OpenShift cluster. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Virtual Machines</strong>: The underlying Azure VMs for both control plane and worker nodes.</p>
</li>
<li>
<p><strong>Networking</strong>: Core networking components required for cluster operation.</p>
</li>
<li>
<p><strong>Storage</strong>: Virtual storage for the cluster&#8217;s operational needs.</p>
</li>
<li>
<p><strong>Physical Infrastructure and Security</strong>: The foundational Azure data center infrastructure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As detailed in the provided context (Table 1. Responsibilities by resource), Microsoft and Red Hat share responsibility across these resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Control plane nodes</strong>: Microsoft and Red Hat are jointly responsible.</p>
</li>
<li>
<p><strong>Worker nodes</strong>: Microsoft and Red Hat manage the underlying infrastructure. Customers are responsible for adding or removing worker nodes as required for application workloads and responding to resource notifications, while Microsoft and Red Hat ensure ample quota is available for scaling operations (Table 3).</p>
</li>
<li>
<p><strong>Virtual Storage</strong>: Managed by Microsoft and Red Hat.</p>
</li>
<li>
<p><strong>Physical Infrastructure and Security</strong>: Managed by Microsoft and Red Hat.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The customer retains responsibility for incident and operations management of customer application data and any custom networking configurations they apply within the cluster (e.g., configuring network policies for their applications).</p>
</div>
<div class="paragraph">
<p>The managed infrastructure model ensures that the platform is robust, secure, and always running on up-to-date and performant Azure resources, backed by the expertise of both cloud and OpenShift specialists.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hands_on_lab_enabling_control_plane_logging_for_visibility"><a class="anchor" href="#_hands_on_lab_enabling_control_plane_logging_for_visibility"></a>Hands-on Lab: Enabling Control Plane Logging for Visibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the control plane and much of the infrastructure are managed by Microsoft and Red Hat, as a customer, you still have crucial visibility into their operations through diagnostic logs. Enabling control plane logs is a vital step for troubleshooting cluster-level issues, understanding how your cluster is behaving, and auditing activities. These logs can be forwarded to Azure Log Analytics Workspace for comprehensive analysis.</p>
</div>
<div class="paragraph">
<p>This activity demonstrates how to enable logging for various control plane components, allowing you to monitor their activities and diagnose potential problems.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>An existing Azure Red Hat OpenShift cluster.</p>
</li>
<li>
<p>An Azure Log Analytics Workspace in the same subscription and resource group as your ARO cluster. If you don&#8217;t have one, create it via the Azure portal or CLI.</p>
</li>
<li>
<p>Azure CLI installed and configured with appropriate permissions to manage diagnostic settings for your ARO cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_steps"><a class="anchor" href="#_steps"></a>Steps</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Identify your ARO Cluster and Log Analytics Workspace Details</strong>
You&#8217;ll need the Subscription ID, Resource Group Name, ARO Cluster Name, and Log Analytics Workspace Name. You can retrieve these using Azure CLI commands:</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash]
----
# Get your Subscription ID
az account show --query id --output tsv</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># Get your ARO cluster details (replace &lt;your-resource-group&gt; and &lt;your-aro-cluster-name&gt;)
az aro show -g &lt;your-resource-group&gt; -n &lt;your-aro-cluster-name&gt; --query "{id: id, resourceGroup: resourceGroup}" -o json</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># Get your Log Analytics Workspace ID (replace &lt;your-log-analytics-resource-group&gt; and &lt;your-log-analytics-workspace-name&gt;)
az monitor log-analytics workspace show -g &lt;your-log-analytics-resource-group&gt; -n &lt;your-log-analytics-workspace-name&gt; --query id --output tsv
----</pre>
</div>
</div>
</li>
<li>
<p><strong>Enable Control Plane Logs</strong>
Use the <code>az monitor diagnostic-settings create</code> command to create a diagnostic setting that forwards control plane logs to your Log Analytics Workspace. This command specifies a list of log categories to enable, including <code>kube-audit</code>, <code>kube-apiserver</code>, <code>kube-controller-manager</code>, and <code>kube-scheduler</code>, which are essential for monitoring the managed control plane.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash]
----
az monitor diagnostic-settings create \
    --name 'Collect-ARO-ControlPlane-Logs' \
    --resource "/subscriptions/&lt;SUBSCRIPTION_ID&gt;/resourceGroups/&lt;ARO_RESOURCE_GROUP_NAME&gt;/providers/Microsoft.ContainerService/managedClusters/&lt;ARO_CLUSTER_NAME&gt;" \
    --workspace "/subscriptions/&lt;LOG_ANALYTICS_SUBSCRIPTION_ID&gt;/resourcegroups/&lt;LOG_ANALYTICS_RESOURCE_GROUP_NAME&gt;/providers/microsoft.operationalinsights/workspaces/&lt;LOG_ANALYTICS_WORKSPACE_NAME&gt;" \
    --logs '[{"category": "karpenter-events","enabled": true},{"category": "kube-audit","enabled": true}, \
              {"category": "kube-apiserver","enabled": true},{"category": "kube-audit-admin","enabled": true}, \
              {"category": "kube-controller-manager","enabled": true},{"category": "kube-scheduler","enabled": true}, \
              {"category": "cluster-autoscaler","enabled": true},{"category": "cloud-controller-manager","enabled": true}]'
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Replace the placeholders (`&lt;SUBSCRIPTION_ID&gt;`, `&lt;ARO_RESOURCE_GROUP_NAME&gt;`, `&lt;ARO_CLUSTER_NAME&gt;`, `&lt;LOG_ANALYTICS_SUBSCRIPTION_ID&gt;`, `&lt;LOG_ANALYTICS_RESOURCE_GROUP_NAME&gt;`, `&lt;LOG_ANALYTICS_WORKSPACE_NAME&gt;`) with your specific details.</pre>
</div>
</div>
</li>
<li>
<p><strong>Verify Log Flow</strong>
After a few minutes, control plane logs should start appearing in your Azure Log Analytics Workspace. You can query them using Kusto Query Language (KQL).</p>
</li>
<li>
<p>Navigate to your Log Analytics Workspace in the Azure portal.</p>
</li>
<li>
<p>Click on "Logs" under the "General" section.</p>
</li>
<li>
<p>Run a simple query to see if logs are being ingested, for example:</p>
<div class="literalblock">
<div class="content">
<pre>[source,kql]
----
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.CONTAINERSERVICE"
| where Category contains "kube"
| take 10
| project TimeGenerated, Category, log_s
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>This query filters for logs from the `MICROSOFT.CONTAINERSERVICE` provider (which includes ARO) and categories related to Kubernetes control plane components.</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_expected_outcome"><a class="anchor" href="#_expected_outcome"></a>Expected Outcome</h3>
<div class="paragraph">
<p>You have successfully configured diagnostic settings to forward crucial control plane logs from your ARO cluster to an Azure Log Analytics Workspace. This provides you with the necessary visibility to monitor the health, activity, and security of the managed components, enabling more effective troubleshooting and operational insights into your ARO environment.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="joint-engineering-operation-and-support-model.html">Joint engineering, operation, and support model</a></span>
  <span class="next"><a href="../aro-cluster-provisioning/aro-cluster-provisioning.html">ARO Cluster Provisioning</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
