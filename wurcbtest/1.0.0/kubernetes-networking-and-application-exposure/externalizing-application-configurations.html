<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Externalizing application configurations :: Advanced Administration of Azure Red Hat OpenShift</title>
    <link rel="prev" href="scaling-and-exposing-applications-to-external-access.html">
    <link rel="next" href="../network-security-policies/network-security-policies.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Advanced Administration of Azure Red Hat OpenShift</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="wurcbtest" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../azure-red-hat-openshift-architecture-and-overview/azure-red-hat-openshift-architecture-and-overview.html">Azure Red Hat OpenShift Architecture and Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../azure-red-hat-openshift-architecture-and-overview/aro-platform-capabilities.html">ARO platform capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../azure-red-hat-openshift-architecture-and-overview/joint-engineering-operation-and-support-model.html">Joint engineering, operation, and support model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../azure-red-hat-openshift-architecture-and-overview/managed-control-plane-and-infrastructure.html">Managed control plane and infrastructure</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../aro-cluster-provisioning/aro-cluster-provisioning.html">ARO Cluster Provisioning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../aro-cluster-provisioning/creating-an-azure-red-hat-openshift-cluster.html">Creating an Azure Red Hat OpenShift cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../aro-cluster-provisioning/creating-a-private-azure-red-hat-openshift-cluster.html">Creating a private Azure Red Hat OpenShift cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-cluster-configuration/core-cluster-configuration.html">Core Cluster Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-additional-storage-classes.html">Configuring additional storage classes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/creating-dedicated-machine-sets.html">Creating dedicated machine sets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-node-autoscaling.html">Configuring node autoscaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-log-forwarding.html">Configuring log forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-cluster-configuration/configuring-custom-dns-and-dns-forwarding.html">Configuring custom DNS and DNS forwarding</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../registry-integrations/registry-integrations.html">Registry Integrations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/integrating-with-azure-container-registry-acr.html">Integrating with Azure Container Registry (ACR)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/integrating-with-quay.html">Integrating with Quay</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registry-integrations/using-the-internal-openshift-registry.html">Using the internal OpenShift registry</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cluster-application-data-management/cluster-application-data-management.html">Cluster Application Data Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-application-data-management/backup-and-restore-of-cluster-applications-using-velero.html">Backup and restore of cluster applications using Velero</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/openshift-and-kubernetes-interfaces.html">OpenShift and Kubernetes Interfaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/navigating-the-openshift-web-console.html">Navigating the OpenShift Web Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/utilizing-the-kubernetes-command-line-interface-cli.html">Utilizing the Kubernetes Command-line Interface (CLI)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openshift-and-kubernetes-interfaces/utilizing-the-openshift-command-line-interface-cli.html">Utilizing the OpenShift Command-line Interface (CLI)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../troubleshooting-and-application-management/troubleshooting-and-application-management.html">Troubleshooting and Application Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-and-application-management/troubleshooting-containers-and-pods.html">Troubleshooting containers and pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-and-application-management/managing-applications-using-the-kubernetes-workload-api.html">Managing applications using the Kubernetes Workload API</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="kubernetes-networking-and-application-exposure.html">Kubernetes Networking and Application Exposure</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="understanding-kubernetes-pod-and-service-networks.html">Understanding Kubernetes Pod and Service Networks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scaling-and-exposing-applications-to-external-access.html">Scaling and exposing applications to external access</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="externalizing-application-configurations.html">Externalizing application configurations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../network-security-policies/network-security-policies.html">Network Security Policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-security-policies/configuring-network-policies.html">Configuring network policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-security-policies/limiting-ingress-traffic.html">Limiting ingress traffic</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../gitops-for-cluster-administration/gitops-for-cluster-administration.html">GitOps for Cluster Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gitops-for-cluster-administration/implementing-openshift-gitops.html">Implementing OpenShift GitOps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../gitops-for-cluster-administration/using-argocd-for-declarative-cluster-management.html">Using ArgoCD for declarative cluster management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../multi-cluster-management/multi-cluster-management.html">Multi-Cluster Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../multi-cluster-management/overview-of-red-hat-advanced-cluster-management-rhacm.html">Overview of Red Hat Advanced Cluster Management (RHACM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../multi-cluster-management/managing-kubernetes-clusters-with-rhacm.html">Managing Kubernetes clusters with RHACM</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../knowledge-share-and-discussions/knowledge-share-and-discussions.html">Knowledge Share and Discussions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/integrating-azure-ad-with-openshift-oauth.html">Integrating Azure AD with OpenShift OAuth</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/integrating-azure-key-vault-with-aro.html">Integrating Azure Key Vault with ARO</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/differentiating-availability-sets-vs-availability-zones.html">Differentiating Availability Sets vs. Availability Zones</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/understanding-azure-spot-instances.html">Understanding Azure Spot Instances</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../knowledge-share-and-discussions/exploring-hosted-control-planes.html">Exploring Hosted Control Planes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab/hands-on-lab.html">Hands-on Lab</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-an-azure-red-hat-openshift-cluster.html">Create an Azure Red Hat OpenShift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-additional-storage-classes.html">Configure additional storage classes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-dedicated-machine-sets.html">Create dedicated machine sets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-node-autoscaling.html">Configure node autoscaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-log-forwarding.html">Configure log forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/create-a-private-azure-red-hat-openshift-cluster.html">Create a private Azure Red Hat OpenShift Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-custom-dns-and-dns-forwarding.html">Configure custom DNS and DNS forwarding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/implement-registry-integrations-with-aro.html">Implement registry integrations with ARO</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/perform-backup-and-restore-of-a-cluster-application-with-velero.html">Perform backup and restore of a cluster application with Velero</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/troubleshoot-containers-and-pods.html">Troubleshoot containers and pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/manage-applications-using-the-kubernetes-workload-api.html">Manage applications using the Kubernetes Workload API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/explore-kubernetes-pod-and-service-networks.html">Explore Kubernetes Pod and Service Networks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/scale-and-expose-applications-to-external-access.html">Scale and expose applications to external access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/externalize-application-configurations.html">Externalize application configurations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/configure-network-policies-and-limit-ingress-traffic.html">Configure network policies and limit ingress traffic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/implement-gitops-for-cluster-administration.html">Implement GitOps for cluster administration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab/manage-a-cluster-using-red-hat-advanced-cluster-management.html">Manage a cluster using Red Hat Advanced Cluster Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Advanced Administration of Azure Red Hat OpenShift</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Advanced Administration of Azure Red Hat OpenShift</a></li>
    <li><a href="kubernetes-networking-and-application-exposure.html">Kubernetes Networking and Application Exposure</a></li>
    <li><a href="externalizing-application-configurations.html">Externalizing application configurations</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Externalizing application configurations</h1>
<h1 id="_externalizing_application_configurations_in_azure_red_hat_openshift" class="sect0"><a class="anchor" href="#_externalizing_application_configurations_in_azure_red_hat_openshift"></a>Externalizing Application Configurations in Azure Red Hat OpenShift</h1>
<div class="paragraph">
<p>In modern cloud-native application development, it&#8217;s a best practice to separate application code from its configuration. This principle, often referred to as the "12-Factor App" methodology, ensures that applications are more portable, scalable, and easier to manage across different environments (development, staging, production). Externalizing application configurations allows you to change how an application behaves without needing to rebuild its image or redeploy the code.</p>
</div>
<div class="sect1">
<h2 id="_why_externalize_configurations"><a class="anchor" href="#_why_externalize_configurations"></a>Why Externalize Configurations?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Externalizing configurations offers several significant benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Portability:</strong> Applications can run identically in various environments, with only the configuration changing.</p>
</li>
<li>
<p><strong>Maintainability:</strong> Configuration changes don&#8217;t require code changes, simplifying updates and reducing the risk of introducing bugs.</p>
</li>
<li>
<p><strong>Security:</strong> Sensitive information (like database passwords or API keys) can be managed separately and securely, often without embedding them directly into application code or container images.</p>
</li>
<li>
<p><strong>Scalability:</strong> Different instances of an application can share the same code but be configured differently (e.g., connecting to different databases).</p>
</li>
<li>
<p><strong>CI/CD Integration:</strong> Streamlines continuous integration and continuous deployment pipelines by allowing configuration to be injected at deployment time.</p>
</li>
<li>
<p><strong>Environment-Specific Settings:</strong> Easily manage variations in settings between development, test, and production environments (e.g., log levels, API endpoints).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In Azure Red Hat OpenShift (ARO), which is built on Kubernetes, the primary mechanisms for externalizing application configurations are <strong>ConfigMaps</strong> and <strong>Secrets</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_mechanisms_for_configuration_management"><a class="anchor" href="#_core_mechanisms_for_configuration_management"></a>Core Mechanisms for Configuration Management</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_configmaps"><a class="anchor" href="#_configmaps"></a>ConfigMaps</h3>
<div class="paragraph">
<p>A ConfigMap is an API object used to store non-confidential data in key-value pairs. Applications can consume ConfigMaps as environment variables, command-line arguments, or as configuration files in a volume. ConfigMaps are ideal for storing configuration data that doesn&#8217;t contain sensitive information, such as application settings, URLs, or feature flags.</p>
</div>
<div class="sect3">
<h4 id="_technical_explanation"><a class="anchor" href="#_technical_explanation"></a>Technical Explanation</h4>
<div class="paragraph">
<p>ConfigMaps provide a way to inject configuration data into pods. They are not designed for sensitive data, but rather for general configuration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Key-Value Pairs:</strong> A ConfigMap stores data in <code>key: value</code> format. The values can be short strings or entire file contents.</p>
</li>
<li>
<p><strong>Data Types:</strong> While typically text, ConfigMaps can store any type of string data.</p>
</li>
<li>
<p><strong>Consumption Methods:</strong></p>
</li>
<li>
<p><strong>Environment Variables:</strong> Individual keys from a ConfigMap can be injected as environment variables into a container.</p>
</li>
<li>
<p><strong>Volume Mounts:</strong> The entire ConfigMap can be mounted as a volume, with each key-value pair represented as a file within the mounted directory. This is particularly useful for configuration files (e.g., <code>application.properties</code>, <code>nginx.conf</code>).</p>
</li>
<li>
<p><strong>Command-Line Arguments:</strong> Values can be passed as command-line arguments to the container&#8217;s entrypoint.</p>
</li>
<li>
<p><strong>Immutability (Optional):</strong> ConfigMaps can be marked as immutable, preventing accidental or malicious updates. This improves stability and performance.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_example_creating_and_using_a_configmap"><a class="anchor" href="#_example_creating_and_using_a_configmap"></a>Example: Creating and Using a ConfigMap</h4>
<div class="paragraph">
<p>Let&#8217;s say you have a simple web application that needs to display a welcome message and an API URL.</p>
</div>
<div class="paragraph">
<div class="title">Create a ConfigMap</div>
<p>First, define a ConfigMap in a YAML file (e.g., <code>my-app-config.yaml</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: my-app-config
data:
  APP_WELCOME_MESSAGE: "Welcome to ARO Applications!"
  API_URL: "https://api.example.com/v1"
  config.properties: |
    # This is a sample properties file
    app.name=MyWebApp
    app.version=1.0.0
    db.connection.timeout=30s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the ConfigMap to your OpenShift cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-config.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Deploy an application consuming the ConfigMap</div>
<p>Now, deploy an application that consumes these configurations. We&#8217;ll show how to use both environment variables and a mounted file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps.openshift.io/v1
kind: DeploymentConfig
metadata:
  name: my-app
spec:
  replicas: 1
  selector:
    app: my-app
  template:
    metadata:
      labels:
        app: my-app
    spec:
      containers:
      - name: my-app-container
        image: quay.io/centos7/httpd-24-centos7:latest # Using a simple HTTPD image for demonstration
        ports:
        - containerPort: 8080
        env:
        - name: WELCOME_MESSAGE
          valueFrom:
            configMapKeyRef:
              name: my-app-config
              key: APP_WELCOME_MESSAGE
        - name: API_ENDPOINT
          valueFrom:
            configMapKeyRef:
              name: my-app-config
              key: API_URL
        volumeMounts:
        - name: config-volume
          mountPath: "/etc/config/"
      volumes:
      - name: config-volume
        configMap:
          name: my-app-config
          items:
          - key: config.properties
            path: config.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the DeploymentConfig:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-deployment.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:
*   <code>WELCOME_MESSAGE</code> and <code>API_ENDPOINT</code> environment variables will be set with values from <code>my-app-config</code>.
*   The <code>config.properties</code> file will be mounted inside the container at <code>/etc/config/config.properties</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For a real application, you would replace <code>quay.io/centos7/httpd-24-centos7:latest</code> with your actual application image and adjust the application&#8217;s code to read these environment variables or configuration files. For HTTPD, you might need to use a custom image with a script that processes these values into HTTPD&#8217;s configuration.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_secrets"><a class="anchor" href="#_secrets"></a>Secrets</h3>
<div class="paragraph">
<p>Secrets are similar to ConfigMaps but are specifically designed to hold sensitive information, such as passwords, OAuth tokens, and SSH keys. OpenShift (Kubernetes) Secrets ensure that sensitive data is not exposed in the application&#8217;s container image or directly in plain text in Pod definitions.</p>
</div>
<div class="sect3">
<h4 id="_technical_explanation_2"><a class="anchor" href="#_technical_explanation_2"></a>Technical Explanation</h4>
<div class="paragraph">
<p>Secrets are fundamental for securing application credentials.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base64 Encoding:</strong> The values stored in Secrets are base64 encoded. This is <strong>not</strong> encryption but rather an encoding mechanism to ensure data can be stored safely within YAML and transported correctly. For true encryption at rest, OpenShift/Kubernetes leverages underlying Azure disk encryption and can be further enhanced with solutions like Azure Key Vault integration.</p>
</li>
<li>
<p><strong>Consumption Methods:</strong> Similar to ConfigMaps, Secrets can be consumed as:</p>
</li>
<li>
<p><strong>Environment Variables:</strong> Individual keys from a Secret can be injected as environment variables.</p>
</li>
<li>
<p><strong>Volume Mounts:</strong> The entire Secret can be mounted as a volume, with each key-value pair represented as a file. This is common for certificates or key files.</p>
</li>
<li>
<p><strong>Security Considerations:</strong></p>
</li>
<li>
<p>Secrets are stored in <code>etcd</code> (the Kubernetes backing store). On ARO, <code>etcd</code> is managed by Microsoft and Red Hat.</p>
</li>
<li>
<p>Access to Secrets is controlled by Kubernetes RBAC.</p>
</li>
<li>
<p>When consumed as environment variables, they are visible to anyone with access to the container&#8217;s environment (e.g., <code>oc exec &lt;pod-name&gt;&#8201;&#8212;&#8201;env</code>).</p>
</li>
<li>
<p>When mounted as files, they reside on the container&#8217;s filesystem.</p>
</li>
<li>
<p>For enhanced security, consider integrating with external secret management solutions like Azure Key Vault or HashiCorp Vault, which is discussed in a later section.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_example_creating_and_using_a_secret"><a class="anchor" href="#_example_creating_and_using_a_secret"></a>Example: Creating and Using a Secret</h4>
<div class="paragraph">
<p>Let&#8217;s imagine our application needs a database password.</p>
</div>
<div class="paragraph">
<div class="title">Create a Secret</div>
<p>First, define your sensitive data. It&#8217;s often best practice to create secrets from files or using the <code>oc create secret</code> command, which handles base64 encoding for you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Create a dummy password file
echo -n 'mySuperSecurePassword123' &gt; db-password.txt

# Create the secret from the file
oc create secret generic my-db-secret --from-file=password=db-password.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can define it in YAML, but you must base64 encode the value yourself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: my-db-secret
type: Opaque # Or kubernetes.io/basic-auth, etc. for specific types
data:
  username: bXlVc2Vy # base64 encoded 'myUser'
  password: bXlTdXBlclNlY3VyZVBhc3N3b3JkMTIz # base64 encoded 'mySuperSecurePassword123'</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can encode a string using <code>echo -n 'your_string' | base64</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Deploy an application consuming the Secret</div>
<p>Now, deploy an application that consumes this Secret.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps.openshift.io/v1
kind: DeploymentConfig
metadata:
  name: my-app-db
spec:
  replicas: 1
  selector:
    app: my-app-db
  template:
    metadata:
      labels:
        app: my-app-db
    spec:
      containers:
      - name: my-app-db-container
        image: registry.access.redhat.com/ubi8/nginx-120:1-120 # Using a simple Nginx image for demonstration
        ports:
        - containerPort: 8080
        env:
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: my-db-secret
              key: username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: my-db-secret
              key: password
        volumeMounts:
        - name: tls-cert
          mountPath: "/etc/tls"
          readOnly: true
      volumes:
      - name: tls-cert
        secret:
          secretName: my-tls-secret # Assuming you have a TLS secret with 'tls.crt' and 'tls.key'
          items:
          - key: tls.crt
            path: tls.crt
          - key: tls.key
            path: tls.key</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply the DeploymentConfig:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-db-deployment.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:
*   <code>DB_USERNAME</code> and <code>DB_PASSWORD</code> environment variables will be set with values from <code>my-db-secret</code>.
*   A theoretical <code>my-tls-secret</code> is mounted as files (<code>tls.crt</code>, <code>tls.key</code>) for HTTPS configuration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_environment_variables_directly"><a class="anchor" href="#_environment_variables_directly"></a>Environment Variables Directly</h3>
<div class="paragraph">
<p>For very simple, non-sensitive, and static configurations, you can directly define environment variables within the container definition in your Pod or Deployment. While this works, it&#8217;s generally less flexible than ConfigMaps, especially for managing changes or sharing configurations across multiple pods.</p>
</div>
<div class="sect3">
<h4 id="_example_direct_environment_variables"><a class="anchor" href="#_example_direct_environment_variables"></a>Example: Direct Environment Variables</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps.openshift.io/v1
kind: DeploymentConfig
metadata:
  name: simple-app
spec:
  replicas: 1
  selector:
    app: simple-app
  template:
    metadata:
      labels:
        app: simple-app
    spec:
      containers:
      - name: simple-app-container
        image: registry.access.redhat.com/ubi8/nginx-120:1-120
        ports:
        - containerPort: 8080
        env:
        - name: APP_COLOR
          value: "blue"
        - name: LOG_LEVEL
          value: "INFO"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is suitable for immutable settings that are tightly coupled with the application&#8217;s deployment.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hands_on_activity_externalizing_application_configuration"><a class="anchor" href="#_hands_on_activity_externalizing_application_configuration"></a>Hands-on Activity: Externalizing Application Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lab, you will deploy a simple web application that displays configurable messages. You will use a ConfigMap to externalize a public message and a Secret to externalize a sensitive API key.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>An active Azure Red Hat OpenShift cluster.</p>
</li>
<li>
<p>The <code>oc</code> CLI configured and logged in to your ARO cluster.</p>
</li>
<li>
<p>A basic understanding of <code>oc</code> commands.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_lab_steps"><a class="anchor" href="#_lab_steps"></a>Lab Steps</h3>
<div class="paragraph">
<div class="title">Step 1: Create a New Project</div>
<p>First, create a new OpenShift project to isolate your lab resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc new-project external-config-lab</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Step 2: Create a ConfigMap for Non-Sensitive Data</div>
<p>We&#8217;ll create a ConfigMap to store a welcome message and a frontend color for our application.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file named <code>my-app-config.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: frontend-config
data:
  WELCOME_MESSAGE: "Hello from ARO! Configuration is Externalized!"
  FRONTEND_COLOR: "lightskyblue"</code></pre>
</div>
</div>
</li>
<li>
<p>Apply the ConfigMap:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-config.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Verify the ConfigMap was created:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get configmap frontend-config -o yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Step 3: Create a Secret for Sensitive Data</div>
<p>Next, we&#8217;ll create a Secret for a hypothetical API key. Remember, Secret data must be base64 encoded.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file named <code>my-app-secret.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: backend-secret
type: Opaque
data:
  API_KEY: c3VwZXJTZWNyZXRBUElLZXk0NTY3ODk= # This is base64 for 'superSecretAPIKey456789'</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To generate the base64 encoded string, you can use: <code>echo -n 'superSecretAPIKey456789' | base64</code>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the Secret:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-secret.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Verify the Secret was created (note that <code>data</code> fields are still base64 encoded by default):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get secret backend-secret -o yaml</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do <strong>not</strong> use <code>-o yaml</code> for secrets in production if you are concerned about exposing base64 encoded values. For this lab, it&#8217;s acceptable.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Step 4: Deploy an Application Consuming the ConfigMap and Secret</div>
<p>We&#8217;ll use a simple Nginx image and a custom entrypoint script to demonstrate reading these configurations.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file named <code>my-app-deployment.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps.openshift.io/v1
kind: DeploymentConfig
metadata:
  name: my-demo-app
  labels:
    app: my-demo-app
spec:
  replicas: 1
  selector:
    app: my-demo-app
  template:
    metadata:
      labels:
        app: my-demo-app
    spec:
      containers:
      - name: app-container
        image: registry.access.redhat.com/ubi8/nginx-120:1-120
        ports:
        - containerPort: 8080
          protocol: TCP
        env:
        - name: GREETING_MESSAGE
          valueFrom:
            configMapKeyRef:
              name: frontend-config
              key: WELCOME_MESSAGE
        - name: APP_BG_COLOR
          valueFrom:
            configMapKeyRef:
              name: frontend-config
              key: FRONTEND_COLOR
        - name: MY_API_KEY
          valueFrom:
            secretKeyRef:
              name: backend-secret
              key: API_KEY
        command: ["/bin/bash", "-c"]
        args:
        - |
          echo "&lt;html&gt;
          &lt;head&gt;&lt;title&gt;ARO Demo App&lt;/title&gt;&lt;/head&gt;
          &lt;body style='background-color: ${APP_BG_COLOR};'&gt;
          &lt;h1&gt;${GREETING_MESSAGE}&lt;/h1&gt;
          &lt;p&gt;Your API Key (for demonstration): ${MY_API_KEY}&lt;/p&gt;
          &lt;p&gt;This configuration is externalized!&lt;/p&gt;
          &lt;/body&gt;
          &lt;/html&gt;" &gt; /usr/share/nginx/html/index.html
          nginx -g "daemon off;"</code></pre>
</div>
</div>
</li>
<li>
<p>Apply the DeploymentConfig:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-deployment.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Wait for the pod to be ready:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get pods -w -l app=my-demo-app</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the pod shows <code>Running</code> status.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Step 5: Expose the Application</div>
<p>Create a route to access your application from a web browser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc expose service my-demo-app --port=8080</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the URL for the application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get route my-demo-app -o jsonpath='{.spec.host}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Copy the URL (e.g., <code>my-demo-app-external-config-lab.apps.your-aro-domain.com</code>).</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Step 6: Verify Externalized Configuration</div>
<p>Open your web browser and navigate to the URL obtained in the previous step.</p>
</div>
<div class="paragraph">
<p>You should see a page with:
*   The welcome message: "Hello from ARO! Configuration is Externalized!"
*   A light skyblue background color.
*   Your API key: "superSecretAPIKey456789".</p>
</div>
<div class="paragraph">
<p>This confirms that your application successfully read the values from the ConfigMap and the Secret.</p>
</div>
<div class="paragraph">
<div class="title">Step 7: Update Configuration and Observe Changes</div>
<p>Let&#8217;s update the welcome message in the ConfigMap.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit <code>my-app-config.yaml</code> to change the <code>WELCOME_MESSAGE</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: frontend-config
data:
  WELCOME_MESSAGE: "Updated message from ARO! Configuration changed!"
  FRONTEND_COLOR: "lightskyblue"</code></pre>
</div>
</div>
</li>
<li>
<p>Apply the updated ConfigMap:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f my-app-config.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Restart the application pod to pick up the new ConfigMap values (ConfigMaps and Secrets mounted as environment variables generally require a pod restart or recreation to take effect. If mounted as files, changes are often reflected, but not always immediately, and some applications might need a reload).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc rollout latest my-demo-app</code></pre>
</div>
</div>
</li>
<li>
<p>Wait for the new pod to be ready and refresh your browser.</p>
<div class="paragraph">
<p>You should now see the updated welcome message.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Step 8: Clean Up</div>
<p>Delete the project and all its resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc delete project external-config-lab</code></pre>
</div>
</div>
<div class="paragraph">
<p>+
Confirm deletion if prompted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting_and_best_practices"><a class="anchor" href="#_troubleshooting_and_best_practices"></a>Troubleshooting and Best Practices</h3>
<div class="ulist">
<ul>
<li>
<p><strong>ConfigMap/Secret Immutability:</strong> For critical configurations, consider marking ConfigMaps and Secrets as immutable to prevent accidental changes (<code>immutable: true</code> in metadata).</p>
</li>
<li>
<p><strong>Rolling Updates:</strong> When a ConfigMap or Secret used as an environment variable is updated, pods typically need to be restarted or redeployed for the changes to take effect. If mounted as files, changes may propagate, but application reload logic might still be required.</p>
</li>
<li>
<p><strong>Secret Management:</strong> For highly sensitive or numerous secrets, consider integrating ARO with external secret management solutions like Azure Key Vault via the Azure Key Vault Provider for Secrets Store CSI Driver or community operators like External Secrets Operator. This prevents secrets from residing directly in <code>etcd</code> in decrypted form (even base64-encoded secrets are easily decodable).</p>
</li>
<li>
<p><strong>Structured Configuration:</strong> For complex applications, organize configurations logically. You might use multiple ConfigMaps or Secrets (e.g., <code>app-frontend-config</code>, <code>app-backend-config</code>, <code>db-secrets</code>).</p>
</li>
<li>
<p><strong>Templates:</strong> Use templating tools like Helm or Kustomize to manage and deploy configurations consistently across environments.</p>
</li>
<li>
<p><strong>Security Context:</strong> Always ensure your pods run with the least necessary privileges when accessing secrets.</p>
</li>
<li>
<p><strong>Audit Logging:</strong> OpenShift and Azure provide extensive audit logging. Monitor access to ConfigMaps and Secrets, especially those containing sensitive information.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="scaling-and-exposing-applications-to-external-access.html">Scaling and exposing applications to external access</a></span>
  <span class="next"><a href="../network-security-policies/network-security-policies.html">Network Security Policies</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
